<!-- carrito-item.component.html -->
<div class="flex items-center bg-white rounded-xl shadow-md p-2 h-21 mb-1 mt-1 relative">

  <!--Botón modificar-->


  <div class="dropdown top-2 right-7">
    <button class=" text-black text-xxs px-1 rounded" type="button" data-bs-toggle="dropdown" aria-expanded="false">
      <img src="../../../../assets/icons/menu-puntos.svg" alt="Icono" width="14" height="14" />
    </button>
    <ul class="dropdown-menu">
      <li>
        <a class="dropdown-item hover:bg-gray-100 cursor-pointer" (click)="abrirModalDescuento()" >Aplicar Descuento</a>
      </li>
    </ul>
  </div>



  <!-- Botón Eliminar -->
  <button (click)="eliminarItem()" class="absolute top-2 right-1 text-black text-xs px-1 rounded ">
    <img src="../../../../assets/icons/cruz.svg" alt="Icono" width="14" height="14" />
  </button>

  <!-- Imagen -->
  <img [src]="articulo.articulo.imagen[0].url" alt="{{ articulo.articulo.nombre }}" class="w-12 h-12 object-cover rounded-lg mr-2" />

  <!-- Detalles del Artículo -->
  <div class="flex-1">
    <h6 class="font-medium">{{ articulo.articulo.nombre | lowercase }}</h6>
    <p class="text-gray-500 text-xs">{{ articulo.articulo.precio | currency }}</p>
  </div>

  <!-- Cantidad -->
  <div class="flex items-center space-x-1">
    <button class="bg-gray-200 text-gray-700 p-1 rounded-full hover:bg-gray-300 mr-1" (click)="disminuirCantidad()">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" />
      </svg>
    </button>
    <span class="text-sm m-2">{{ articulo.cantidad }}</span>
    <button class="bg-gray-200 text-gray-700 p-1 rounded-full hover:bg-gray-300 ml-1" (click)="aumentarCantidad()">
      <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
      </svg>
    </button>
  </div>
</div>


<!-- Modal -->
<div *ngIf="mostrarModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50">
  <div class="bg-white p-6 rounded-2xl shadow-xl w-96">
    <h2 class="text-xl font-semibold mb-4 text-gray-800">Aplicar Descuento</h2>

    <p class="text-sm text-gray-700">Artículo: <span class="font-medium">{{ articulo.articulo.nombre }}</span></p>
    <p class="text-sm text-gray-500">
      Precio Original:
      <span class="font-semibold text-gray-800">{{ articulo.articulo.precio | currency }}</span>
    </p>

    <!-- Selección de tipo de descuento -->
    <div class="mt-4">
      <label class="block text-sm font-medium text-gray-700">Tipo de Descuento</label>
      <select [(ngModel)]="tipoDescuento" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400">
        <option value="porcentaje">Porcentaje (%)</option>
        <option value="monto">Monto Fijo</option>
      </select>
    </div>

    <!-- Input para el valor del descuento -->
    <div class="mt-4">
      <label class="block text-sm font-medium text-gray-700">Valor del Descuento</label>
      <input [(ngModel)]="valorDescuento" type="number"
             class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-400" />
    </div>

    <!-- Mostrar precio final -->
    <p class="text-sm mt-4 text-gray-700">
      Precio Final: <span class="font-semibold text-green-600">{{ calcularPrecioFinal() | currency }}</span>
    </p>

    <!-- Botones de acción -->
    <div class="flex justify-end space-x-2 mt-6">
      <button (click)="mostrarModal = false" class="px-4 py-2 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300">
        Cancelar
      </button>
      <button (click)="aplicarDescuento()"
              class="px-4 py-2 rounded-lg bg-blue-600 text-white hover:bg-blue-700">
        Aplicar
      </button>
    </div>
  </div>
</div>
